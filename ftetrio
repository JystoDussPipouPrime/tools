#!/bin/bash

set -e

DEB_URL="https://tetr.io/about/desktop/builds/10/TETR.IO%20Setup.deb"
TMP_DEB="/tmp/tetrio_latest.deb"

wget -O "$TMP_DEB" "$DEB_URL"

sudo apt update
sudo apt install -y "$TMP_DEB"

rm "$TMP_DEB"

# config.ttc
# {"controls":{"style":"custom","custom":{"moveLeft":["ARROWLEFT"],"moveRight":["ARROWRIGHT"],"softDrop":["ARROWUP"],"hardDrop":["ARROWDOWN"],"rotateCCW":["KEYZ"],"rotateCW":["KEYX"],"rotate180":["SHIFTLEFT"],"hold":["KEYC"],"exit":["ESCAPE","KEYR"],"retry":["KEYT"],"chat":["BACKQUOTE"],"target1":["DIGIT1"],"target2":["DIGIT2"],"target3":["DIGIT3"],"target4":["DIGIT4"],"menuUp":["ARROWUP"],"menuDown":["ARROWDOWN"],"menuLeft":["ARROWLEFT"],"menuRight":["ARROWRIGHT"],"menuBack":["ESCAPE"],"menuConfirm":["KEYA"],"openSocial":["TAB"]},"sensitivity":0.5,"vibration":1},"handling":{"arr":1,"das":5.4,"dcd":0,"sdf":41,"safelock":true,"cancel":false,"may20g":true},"volume":{"disable":false,"music":0,"sfx":0.10000000000000002,"stereo":0.5,"others":true,"attacks":true,"next":false,"noreset":true,"oof":true,"scrollable":true,"bgmtweak":{}},"video":{"graphics":"low","caching":"medium","actiontext":"all","particles":"0.1","background":"0.76","bounciness":"0","shakiness":"0","gridopacity":0.1,"boardopacity":0.85,"shadowopacity":0.15,"zoom":1,"alwaystiny":false,"nosuperlobbyanim":false,"nozenithanim":false,"colorshadow":false,"holdlocked":true,"sidebyside":true,"spin":false,"chatfilter":false,"background_url":null,"background_usecustom":null,"nochat":false,"hideroomids":false,"emotes":true,"emotes_anim":true,"siren":true,"powersave":false,"invert":false,"nobg":false,"chatbg":true,"replaytoolsnocollapse":true,"kos":true,"fire":false,"focuswarning":true,"hidenetwork":false,"guide":false,"lowrescounters":false,"desktopnotifications":true,"lowres":false,"webgl":"webgl2","bloom":"0","chroma":"0","flashwave":"0"},"gameoptions":{"pro_40l":false,"pro_40l_alert":false,"pro_40l_retry":false,"stride_40l":false,"pro_blitz":false,"pro_blitz_alert":false,"pro_blitz_retry":false,"stride_blitz":false},"electron":{"loginskip":"always","frameratelimit":"2x","presence":true,"taskbarflash":true,"autoupdate":true,"anglecompat":false,"adblock":false},"notifications":{"suppress":false,"forcesound":true,"online":"ingame","offline":"off","dm":"both","dm_pending":"both","invite":"both","other":"both"}}

# 4w_default.ttp
# {"bagtype":"7-bag","spinbonuses":"handheld","combotable":"multiplier","allclears":true,"seed_random":true,"seed":0,"can_retry":true,"stock":0,"clutch":true,"nolockout":true,"boardwidth":4,"boardheight":26,"survivalmode":"none","survival_messiness":100,"survival_cap":0,"survival_layer_amt":9,"survival_layer_non":true,"survival_layer_min":3,"survival_timer_itv":60,"allow180":true,"kickset":"SRS-X","allow_harddrop":true,"display_next":true,"display_hold":true,"nextcount":5,"infinite_movement":false,"infinite_hold":false,"display_shadow":true,"are":0,"lineclear_are":0,"g":0.02,"levels":false,"masterlevels":false,"startinglevel":0,"levelspeed":0,"levelstatic":false,"levelstaticspeed":0,"levelgbase":0.8,"levelgspeed":0,"locktime":30,"objective_type":"none","objective_count":100,"objective_time":120000,"objective_result":"time","topoutisclear":true,"pro":false,"mission":"COMBO","stride":true,"countdown":true,"countdown_count":3,"countdown_interval":1000,"precountdown":3000,"prestart":1000,"zoominto":"slow","slot_counter1":"stopwatch","slot_counter2":"pieces","slot_counter3":"---empty---","slot_counter4":"---empty---","slot_counter5":"lines","absolute_lines":true,"slot_bar2":"progress"}

# 4w_6res.ttp
# {"bagtype":"7-bag","spinbonuses":"handheld","combotable":"multiplier","allclears":true,"seed_random":true,"seed":0,"can_retry":true,"stock":0,"clutch":true,"nolockout":true,"boardwidth":4,"boardheight":26,"survivalmode":"none","survival_messiness":100,"survival_cap":0,"survival_layer_amt":9,"survival_layer_non":true,"survival_layer_min":3,"survival_timer_itv":60,"allow180":true,"kickset":"SRS-X","allow_harddrop":true,"display_next":true,"display_hold":true,"nextcount":5,"infinite_movement":false,"infinite_hold":false,"display_shadow":true,"are":0,"lineclear_are":0,"g":0.02,"levels":false,"masterlevels":false,"startinglevel":0,"levelspeed":0,"levelstatic":false,"levelstaticspeed":0,"levelgbase":0.8,"levelgspeed":0,"locktime":30,"objective_type":"none","objective_count":100,"objective_time":120000,"objective_result":"time","topoutisclear":true,"pro":false,"map":"________________________________________________________________________________________________#_#####_??","mission":"COMBO","stride":true,"countdown":true,"countdown_count":3,"countdown_interval":1000,"precountdown":3000,"prestart":1000,"zoominto":"slow","slot_counter1":"stopwatch","slot_counter2":"pieces","slot_counter3":"---empty---","slot_counter4":"---empty---","slot_counter5":"lines","absolute_lines":true,"slot_bar2":"progress"}

# 4w_3res.ttp
# {"bagtype":"7-bag","spinbonuses":"handheld","combotable":"multiplier","allclears":true,"seed_random":true,"seed":0,"can_retry":true,"stock":0,"clutch":true,"nolockout":true,"boardwidth":4,"boardheight":26,"survivalmode":"timer","survival_messiness":100,"survival_cap":2,"survival_layer_amt":0,"survival_layer_non":true,"survival_layer_min":0,"survival_timer_itv":1e+75,"allow180":true,"kickset":"SRS-X","allow_harddrop":true,"display_next":true,"display_hold":true,"nextcount":5,"infinite_movement":false,"infinite_hold":false,"display_shadow":true,"are":0,"lineclear_are":0,"g":0.02,"levels":false,"masterlevels":false,"startinglevel":0,"levelspeed":0,"levelstatic":false,"levelstaticspeed":0,"levelgbase":0.8,"levelgspeed":0,"locktime":30,"objective_type":"none","objective_count":100,"objective_time":120000,"objective_result":"time","topoutisclear":true,"pro":false,"mission":"COMBO","stride":true,"countdown":true,"countdown_count":3,"countdown_interval":1000,"precountdown":3000,"prestart":1000,"zoominto":"slow","slot_counter1":"stopwatch","slot_counter2":"pieces","slot_counter3":"---empty---","slot_counter4":"---empty---","slot_counter5":"lines","absolute_lines":true,"slot_bar2":"progress"}
